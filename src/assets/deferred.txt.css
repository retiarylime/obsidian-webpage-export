/* Define default values for variables */
body
{
    --line-width: 40em;
    --line-width-adaptive: 40em;
    --file-line-width: 40em;
    --sidebar-width: min(20em, 80vw);
    --collapse-arrow-size: 11px;
    --tree-vertical-spacing: 1.3em;
    --sidebar-margin: 12px;
}

:root
{
    background-color: #202124;
}

/*#region Sidebars */

.sidebar {
    height: 100%;
    font-size: 14px;
    z-index: 10;
    min-width: calc(var(--sidebar-width) + var(--divider-width-hover));
    max-width: calc(var(--sidebar-width) + var(--divider-width-hover));
    position: relative;
    overflow: hidden;
    overflow: clip;

    transition: min-width ease-in-out, max-width ease-in-out;
    transition-duration: .2s;
    contain: size;
}

#left-sidebar {
    left: 0;
}

#right-sidebar {
    right: 0;
}

.sidebar.is-collapsed {
    min-width: 0;
    max-width: 0;
}

.sidebar.floating {
    position: absolute;
}

.sidebar .leaf-content {
    height: 100%;
    min-width: calc(var(--sidebar-width) - var(--divider-width-hover));
    top: 0;
    padding: var(--sidebar-margin);
    padding-top: 4em;
    line-height: var(--line-height-tight);
    background-color: var(--background-secondary);
    transition: background-color,border-right,border-left,box-shadow;
    transition-duration: var(--color-fade-speed);
    transition-timing-function: ease-in-out;
    position: absolute;
    display: flex;
    flex-direction: column;
}

/* If the sidebar isn't collapsed the content should have the same width as it */
.sidebar:not(.is-collapsed) .leaf-content {
    min-width: calc(max(100%,var(--sidebar-width)) - 3px);
    max-width: calc(max(100%,var(--sidebar-width)) - 3px);
}

#left-sidebar-content
{
    left: 0;
    border-top-right-radius: var(--radius-l);
    border-bottom-right-radius: var(--radius-l);
}

#right-sidebar-content
{
    right: 0;
    border-top-left-radius: var(--radius-l);
    border-bottom-left-radius: var(--radius-l);
}

.sidebar #right-sidebar-content, .sidebar #left-sidebar-content
{
    contain: none !important;
    container-type: normal !important;
    animation: none !important;
}

/* Hide empty sidebars */
.sidebar:has(.leaf-content:empty):has(.topbar-content:empty)
{
    display: none;
}

.sidebar-topbar {
    height: calc(2.3em + 2 * var(--sidebar-margin));
    width: var(--sidebar-width);
    padding: var(--sidebar-margin);
    z-index: 1;

    position: fixed;
    display: flex;
    align-items: center;

    transition: width ease-in-out;
    transition-duration: inherit;
}

.sidebar.is-collapsed .sidebar-topbar {
    width: calc(2.3em + var(--sidebar-margin) * 2);
}

.sidebar .sidebar-topbar.is-collapsed
{
    width: 0;
}

#left-sidebar .sidebar-topbar {
    left: 0;
    flex-direction: row;
	border-top-right-radius: var(--radius-l);
}

#right-sidebar .sidebar-topbar {
    right: 0;
    flex-direction: row-reverse;
	border-top-left-radius: var(--radius-l);
}

#left-sidebar .topbar-content {
    margin-right: calc(2.3em + var(--sidebar-margin));
    flex-direction: row;
}

#right-sidebar .topbar-content {
    margin-left: calc(2.3em + var(--sidebar-margin));
    flex-direction: row-reverse;
}

.topbar-content {
    overflow: hidden visible;
    overflow: clip visible;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    transition: inherit;
}

.sidebar.is-collapsed .topbar-content {
    width: 0;
    transition: inherit;
}

.clickable-icon.sidebar-collapse-icon {
    background-color: transparent;
    color: var(--icon-color-focused); 
    padding: 0px!important;
    margin: 0!important;
    height: 100%!important;
    width: 2.3em !important;
    margin-inline: 0.14em!important;
    position: absolute;
}

#left-sidebar .clickable-icon.sidebar-collapse-icon {
    right: 6px;
}

#right-sidebar .clickable-icon.sidebar-collapse-icon {
    left: 6px;
}

.clickable-icon.sidebar-collapse-icon svg.svg-icon {
    width: 40%;
    height: 40%;
    opacity: 0.5; /* Moved from separate rule to avoid duplication */
}

/* Custom styling for left and right sidebar triangle icons */
#left-sidebar .clickable-icon.sidebar-collapse-icon svg.left-sidebar-triangle {
    transform: rotateY(180deg); /* Rotate 180° when expanded (pointing left away from center) */
    transition: transform 0.3s ease;
}

#right-sidebar .clickable-icon.sidebar-collapse-icon svg.right-sidebar-triangle {
    transform: rotateY(180deg); /* Rotate 180° when expanded (pointing right away from center) */
    transition: transform 0.3s ease;
}

/* Collapsed state animations - return to original orientation */
#left-sidebar.sidebar.is-collapsed .clickable-icon.sidebar-collapse-icon svg.left-sidebar-triangle {
    transform: rotateY(0deg); /* Original orientation when collapsed (pointing right toward center) */
}

#right-sidebar.sidebar.is-collapsed .clickable-icon.sidebar-collapse-icon svg.right-sidebar-triangle {
    transform: rotateY(0deg); /* Original orientation when collapsed (pointing left toward center) */
}

/* Hover effects */
#left-sidebar .clickable-icon.sidebar-collapse-icon:hover svg.left-sidebar-triangle {
    color: var(--interactive-accent);
    transform: rotateY(180deg) scale(1.1); /* Maintain expanded state orientation and add scaling */
}

#right-sidebar .clickable-icon.sidebar-collapse-icon:hover svg.right-sidebar-triangle {
    color: var(--interactive-accent);
    transform: rotateY(180deg) scale(1.1); /* Maintain expanded state orientation and add scaling */
}

#left-sidebar.sidebar.is-collapsed .clickable-icon.sidebar-collapse-icon:hover svg.left-sidebar-triangle {
    color: var(--interactive-accent);
    transform: rotateY(0deg) scale(1.1); /* Maintain collapsed state orientation and add scaling */
}

#right-sidebar.sidebar.is-collapsed .clickable-icon.sidebar-collapse-icon:hover svg.right-sidebar-triangle {
    color: var(--interactive-accent);
    transform: rotateY(0deg) scale(1.1); /* Maintain collapsed state orientation and add scaling */
}

/* Mobile phone specific styles */
body.is-phone #left-sidebar.is-collapsed .sidebar-collapse-icon svg {
    position: relative;
    left: -21px; /* Adjust this value as needed */
}

body.is-phone #left-sidebar .sidebar-collapse-icon svg {
    position: relative;
    left: 10px; /* Adjust this value as needed */
}

body.is-phone #right-sidebar.is-collapsed .sidebar-collapse-icon svg {
    position: relative;
    right: -18px; /* Adjust this value as needed */
}

body.is-phone #right-sidebar .sidebar-collapse-icon svg {
    position: relative;
    right: 10px; /* Adjust this value as needed */
}

body.is-phone .markdown-preview-view {
    padding-left: 15px !important;
    padding-right: 3px !important;
    padding-top: 8px !important;
}

body.is-phone {
    font-size:90%;
}

.feature-title {
    margin-left: 1px;
    text-transform: uppercase;
    letter-spacing: .06em;
    margin-top: 0.75em;
    margin-bottom: 0.75em;
}

.feature-header
{
    display: flex;
    align-items: center;
    padding-top: 0;
    font-size: 1em;
    padding-left: 0;
}

body.floating-sidebars .sidebar
{
    position: absolute;
}

/*#endregion */

/*#region Content / Markdown Preview View */

body
{
    transition: background-color var(--color-fade-speed) ease-in-out;
}

#navbar:not(:empty)
{
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 0.5em 1em;
	width: 100%;
}

#main {
	display: flex;
	flex-direction: column;
	height: 100%;
	width: 100%;
	align-items: stretch;
	justify-content: center;
}

#main-horizontal {
    display: flex;
    flex-direction: row;
	flex-grow: 1;
    width: 100%;
    align-items: stretch;
    justify-content: center;
}

#center-content 
{
    flex-basis: 100%;
    max-width: 100%;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: opacity 0.2s ease-in-out;
    contain: inline-size;
}

.hide
{
    opacity: 0 !important;
    transition: opacity 0.2s ease-in-out;
    pointer-events: none;
}

#center-content>.obsidian-document 
{
    padding-left: 2em;
    padding-right: 1em;
    margin-bottom: 0;
    width: 100%;
    width: -webkit-fill-available;
    width: -moz-available;
    width: fill-available;
    transition: background-color var(--color-fade-speed) ease-in-out;
    border-top-right-radius: var(--window-radius, var(--radius-m));
    border-top-left-radius: var(--window-radius, var(--radius-m));
    overflow-x: hidden !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    contain: inline-size;
}

body #center-content>.obsidian-document>.markdown-preview-sizer 
{
    padding-bottom: 80vh;
    width: 100%;
    max-width: var(--line-width);
    flex-basis: var(--line-width);
    transition: background-color var(--color-fade-speed) ease-in-out;
    contain: inline-size;
}

#center-content>.obsidian-document>div
{
    width: 100% !important;
    transition: background-color var(--color-fade-speed) ease-in-out;
    contain: inline-size;
}

/* If the markdown view is displaying a raw file or embed then increase it's size to make everything as large as possible */
#center-content > .obsidian-document:not([data-type='markdown']).embed {
    display: flex;
    padding: 1em;
    height: 100%;
    width: 100%;
    align-items: center;
    justify-content: center;
}

#center-content > .obsidian-document:not([data-type='markdown']).embed > *
{
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

:not(h1,h2,h3,h4,h5,h6,li):has(> :is(.math, table)) 
{
    overflow-x: auto !important;
}

/* For custom view exports */
#center-content > .obsidian-document:not([data-type='markdown'])
{
    overflow-x: auto;
    contain: content;
    padding: 0;
    margin: 0;
    height: 100%;
}

.obsidian-document[data-type="attachment"]
{
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
}

.obsidian-document[data-type="attachment"] > *
{
    outline: none;
    border: none;
    box-shadow: none;
}

.obsidian-document[data-type="attachment"] :is(img)
{
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
}

.obsidian-document[data-type="attachment"] > :is(audio)
{
    width: 100%;
    max-width: min(90%, var(--line-width));
}

.obsidian-document[data-type="attachment"] > :is(embed, iframe, video)
{
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.canvas-wrapper > :is(.header, .footer)
{
    z-index: 100;
    position: absolute;
    display: flex;
    justify-content: center;
    flex-direction: column;
    width: 100%;
    align-items: center;
}

/*#endregion */

/*#region Loading */

.scroll-highlight 
{
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1000;
    background-color: hsla(var(--color-accent-hsl),.25);
    opacity: 0;
    padding: 1em;
    inset: 50%;
    translate: -50% -50%;
    border-radius: var(--radius-s);
}

/*#endregion */

/*#region Font Import */

@import url('https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap');

/* Define Ubuntu font family with comprehensive mobile-friendly fallbacks */
/* Includes Android system fonts (Roboto, Droid Sans) and iOS/other system fonts */
:root {
    --font-family-ubuntu: 'Ubuntu', 'Roboto', 'Droid Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
    --font-family-ubuntu-mono: 'Ubuntu Mono', 'Roboto Mono', 'Droid Sans Mono', 'SF Mono', Monaco, Inconsolata, 'Liberation Mono', 'Courier New', monospace;
}

/* Custom font-face declarations with mobile optimization */
@font-face {
    font-family: 'Ubuntu-Optimized';
    font-style: normal;
    font-weight: 400;
    font-display: swap; /* Critical for mobile performance - shows fallback text immediately */
    src: url('https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgo6eAT3v02QFg.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
    font-family: 'Ubuntu-Optimized';
    font-style: normal;
    font-weight: 500;
    font-display: swap;
    src: url('https://fonts.gstatic.com/s/ubuntu/v20/4iCs6KVjbNBYlgo6eAT3v02QFg.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
    font-family: 'Ubuntu-Optimized';
    font-style: normal;
    font-weight: 700;
    font-display: swap;
    src: url('https://fonts.gstatic.com/s/ubuntu/v20/4iCv6KVjbNBYlgoCxCvjsGyN.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* Apply optimized Ubuntu fonts globally with mobile-friendly fallbacks */
body {
    font-family: var(--font-family-ubuntu);
}

/* Ensure critical elements use optimized fonts */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-family-ubuntu);
}

/* Navigation elements with mobile optimization */
.nav-file-title, .nav-folder-title, .tree-item-inner {
    font-family: var(--font-family-ubuntu);
}

/* Mobile-specific font optimizations */
@media (max-width: 768px) {
    body {
        line-height: 1.6;
        /* Use system fonts on very slow connections as fallback */
        font-family: 'Ubuntu', 'Roboto', system-ui, -apple-system, sans-serif;
    }
    
    /* Optimize heading sizes for mobile screens */
    h1, h2, h3, h4, h5, h6 {
        font-family: var(--font-family-ubuntu);
        font-weight: 500; /* Use medium weight for better mobile rendering */
    }
}

/* High-DPI display optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    body {
        /* Sharper font rendering on high-DPI Android devices */
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
}

/*#endregion */

/*#region Mobile Phone Heading Styles */

body.is-phone .heading-collapse-indicator
{
    opacity: 1;
    transition: opacity .15s ease-in-out;
    position: absolute;
    z-index: 1;
    padding-left: 40px !important;
    padding-right: 40px !important;
    right: -30px !important;
    left: unset !important;
}

body.is-phone {
    --h1-size: 1.702em;
    --h2-size: 1.402em;
    --h3-size: 1.324em;
    --h4-size: 1.266em;
    --h5-size: 1.125em;
    --h6-size: 1em;
}

body.is-phone .heading-collapse-indicator.collapse-icon.is-collapsed>svg {
	transition: transform 0.1s ease-in-out;
	transform: rotate(90deg);
}

.header .data-bar:not(:empty) {
    padding-bottom: 1em;
    margin-bottom: 1em;
    border-bottom: 3px solid #434242;
}

.header .data-bar {
    display: flex;
    flex-wrap: wrap;
    padding-bottom: 1em;
    margin-bottom: 1em;
    border-bottom: 3px solid #434242;
}

/*#endregion */

/*#region Responsive Design */

body:not(.is-large-screen) {
    --sidebar-width-right: min(20em, 60vw);
    --sidebar-width-left: min(20em, 60vw);
}

body:not(.is-large-screen) input[type=search], 
body:not(.is-large-screen) .nav-file-title, 
body:not(.is-large-screen) .nav-folder-title, 
body:not(.is-large-screen) .tree-item-inner.heading-link 
{
    font-size: 0.9em;
}

body:not(.is-large-screen) .tree-container .feature-title,
body:not(.is-large-screen) .feature-title 
{
    font-size: 0.9em !important;
}

/*#endregion */


